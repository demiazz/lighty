<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>application.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="module-application-Application.html">Application</a><ul class='methods'><li data-type='method'><a href="module-application-Application.html#component">component</a></li><li data-type='method'><a href="module-application-Application.html#start">start</a></li><li data-type='method'><a href="module-application-Application.html#vitalize">vitalize</a></li></ul></li><li><a href="module-builder-Builder.html">Builder</a><ul class='methods'><li data-type='method'><a href="module-builder-Builder.html#checkAndUpdateCache">checkAndUpdateCache</a></li><li data-type='method'><a href="module-builder-Builder.html#createComponent">createComponent</a></li><li data-type='method'><a href="module-builder-Builder.html#getInitializer">getInitializer</a></li><li data-type='method'><a href="module-builder-Builder.html#transformComponent">transformComponent</a></li></ul></li><li><a href="module-plugin-Plugin.html">Plugin</a><ul class='methods'><li data-type='method'><a href="module-plugin-Plugin.html#transform">transform</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-application.html">application</a></li><li><a href="module-builder.html">builder</a></li><li><a href="module-index.html">index</a><ul class='methods'><li data-type='method'><a href="module-index.html#.createApplication">createApplication</a></li><li data-type='method'><a href="module-index.html#.createPlugin">createPlugin</a></li></ul></li><li><a href="module-plugin.html">plugin</a></li><li><a href="module-query-selector.html">query-selector</a><ul class='methods'><li data-type='method'><a href="module-query-selector.html#~filterElements">filterElements</a></li><li data-type='method'><a href="module-query-selector.html#~getMatchesFn">getMatchesFn</a></li><li data-type='method'><a href="module-query-selector.html#~matches">matches</a></li><li data-type='method'><a href="module-query-selector.html#~querySelector">querySelector</a></li></ul></li></ul><h3>Externals</h3><ul><li><a href="external-Element.html">Element</a></li><li><a href="external-jQuery.html">jQuery</a></li><li><a href="external-MatchesFn.html">MatchesFn</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<div id="main">
    
    <h1 class="page-title">application.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Provides Application class.
 *
 * @module application
 *
 * @protected
 * @since 0.2.0
 */

import Builder from './builder';
import querySelector from './query-selector';


/**
 * Creates an application and start them immediately or when a document
 * will be loaded.
 *
 * @property {Array.&lt;module:builder~Builder>} builders - list of builders.
 * @property {Boolean} isRunning - flag which indicates application running or not.
 * @property {QuerySelector} querySelector - query selector used by application.
 * @property {Array.&lt;module:plugin~Plugin>} plugins - list of plugins.
 *
 * @public
 * @since 0.2.0
 */
class Application {
  /**
   * Creates an application instance.
   *
   * @param {ApplicationOptions} [options = { }] - options object.
   */
  constructor(options = { }) {
    this.builders = [];
    this.isRunning = false;

    // Query selector

    this.querySelector = options.querySelector || querySelector;

    // Plugins

    this.plugins = [];

    if (options.plugins) {
      this.plugins = options.plugins.map((plugin) => {
        if (plugin instanceof Function) {
          return plugin();
        }

        return plugin;
      });
    }

    // Running

    if (document.readyState !== 'loading') {
      // See https://connect.microsoft.com/IE/feedback/details/792880/document-readystat
      setTimeout(this.start.bind(this), 1);
    } else {
      document.addEventListener('DOMContentLoaded', this.start.bind(this));
    }
  }

  /**
   * Creates {@link module:builder~Builder} instance for specified selector
   * and prototype, and register them inside of application.
   *
   * Creates the {@link ComponentPrototype}'s instances for all suitable
   * components on a page if application already running.
   *
   * @param {Selector} selector - specified CSS selector.
   * @param {ComponentPrototype} proto - specified prototype.
   *
   * @return {Void} nothing.
   *
   * @public
   * @since 0.2.0
   */
  component(selector, proto) {
    const id = this.builders.length;
    const builder = new Builder(
      id, selector, proto, this.plugins, this.querySelector
    );

    this.builders.push(builder);

    if (this.isRunning) {
      const initializer = builder.getInitializer();

      initializer();
    }
  }

  /**
   * Creates components through all registered {@link module:builder~Builder}s
   * for all elements inside specified tree.
   *
   * @param {Tree} tree - specified tree.
   *
   * @return {Void} nothing.
   *
   * @public
   * @since 0.2.0
   */
  vitalize(tree) {
    this.builders.forEach((builder) => {
      const initialize = builder.getInitializer(tree);

      initialize();
    });
  }

  /**
   * Sets `isRunning` flag to true and vitalizes all elements on a page.
   *
   * @return {Void} nothing.
   *
   * @private
   * @since 0.2.0
   */
  start() {
    this.isRunning = true;

    this.vitalize();
  }
}


export default Application;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
