{"version":3,"file":null,"sources":["../src/builder.js","../src/query-selector.js","../src/application.js","../src/plugin.js","../src/index.js"],"sourcesContent":["export default class Builder {\n  constructor(id, selector, proto, plugins, querySelector) {\n    this.id = id;\n    this.selector = selector;\n    this.proto = proto;\n    this.plugins = plugins;\n    this.querySelector = querySelector;\n  }\n\n  getInitializer(tree = document.body) {\n    const nodes = this.querySelector(tree, this.selector);\n\n    const components = nodes.reduce((cs, node) => {\n      if (this.checkAndUpdateCache(node)) {\n        cs.push(this.createComponent(node));\n      }\n\n      return cs;\n    }, []);\n\n    return function initializer() {\n      components.forEach((component) => {\n        if (!component.init) {\n          return;\n        }\n\n        component.init();\n      });\n    };\n  }\n\n  createComponent(node) {\n    const component = Object.keys(this.proto).reduce((instance, property) => {\n      instance[property] = this.proto[property];\n\n      return instance;\n    }, { });\n\n    this.transformComponent(component, node);\n\n    return component;\n  }\n\n  checkAndUpdateCache(node) {\n    if (node.ids && node.ids.indexOf(this.id) !== -1) {\n      return false;\n    }\n\n    node.ids = node.ids ? node.ids.concat(this.id) : [this.id];\n\n    return true;\n  }\n\n  transformComponent(component, node) {\n    this.plugins.forEach((plugin) => {\n      plugin.transform(component, node);\n    });\n  }\n}\n","function getMatchesFn() {\n  const e = document.documentElement;\n\n  return (\n    e.matches ||\n    e.matchesSelector ||\n    e.msMatchesSelector ||\n    e.mozMatchesSelector ||\n    e.webkitMatchesSelector ||\n    e.oMatchesSelector\n  );\n}\n\nconst matchesFn = getMatchesFn();\n\nfunction matches(element, selector) {\n  return matchesFn.call(element, selector);\n}\n\nexport default function querySelector(tree, selector) {\n  if (tree.jquery) {\n    return tree.filter(selector).add(tree.find(selector)).toArray();\n  }\n\n  let roots;\n\n  if (tree instanceof HTMLElement) {\n    roots = [tree];\n  } else if (tree instanceof NodeList) {\n    roots = [].slice.call(tree);\n  } else if (Array.isArray(tree)) {\n    roots = tree;\n  } else if (typeof tree === 'string') {\n    roots = [].slice.call(document.querySelectorAll(tree));\n  }\n\n  return roots.reduce((nodes, root) => {\n    if (matches(root, selector)) {\n      nodes.push(root);\n    }\n\n    return nodes.concat(\n      [].slice.call(root.querySelectorAll(selector))\n    );\n  }, []);\n}\n","import Builder from './builder';\nimport querySelector from './query-selector';\n\n\nexport default class Application {\n  constructor(options = { }) {\n    this.builders = [];\n    this.isRunning = false;\n\n    // Query selector\n\n    this.querySelector = options.querySelector || querySelector;\n\n    // Plugins\n\n    this.plugins = [];\n\n    if (options.plugins) {\n      this.plugins = options.plugins.map((plugin) => {\n        if (plugin instanceof Function) {\n          return plugin();\n        }\n\n        return plugin;\n      });\n    }\n\n    // Running\n\n    if (document.readyState !== 'loading') {\n      this.isRunning = true;\n    } else {\n      document.addEventListener('DOMContentLoaded', () => {\n        this.isRunning = true;\n\n        this.vitalize();\n      });\n    }\n  }\n\n  component(selector, proto) {\n    const id = this.builders.length;\n    const builder = new Builder(\n      id, selector, proto, this.plugins, this.querySelector\n    );\n\n    this.builders.push(builder);\n\n    if (this.isRunning) {\n      const initializer = builder.getInitializer();\n\n      initializer();\n    }\n\n    return this;\n  }\n\n  vitalize(tree) {\n    this.builders.forEach((builder) => {\n      const initialize = builder.getInitializer(tree);\n\n      initialize();\n    });\n  }\n}\n","export default class Plugin {\n  constructor(name, transformer) {\n    this.name = name;\n    this.transformer = transformer;\n  }\n\n  transform(component, node) {\n    this.transformer(component, node);\n  }\n}\n","import Application from './application';\nimport Plugin from './plugin';\nimport querySelector from './query-selector';\n\n\nexport { querySelector };\n\nexport function create(options) {\n  return new Application(options);\n}\n\nexport function plugin(name, initializer) {\n  return function factory(...args) {\n    return new Plugin(name, initializer(...args));\n  };\n}\n"],"names":["this","const","let"],"mappings":"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"}