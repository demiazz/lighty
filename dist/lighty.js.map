{"version":3,"file":null,"sources":["../src/selector.js","../src/builder.js","../src/application.js","../src/plugin.js","../src/index.js"],"sourcesContent":["function getMatchesFn() {\n  const e = document.documentElement;\n\n  return (\n    e.matches ||\n    e.matchesSelector ||\n    e.msMatchesSelector ||\n    e.mozMatchesSelector ||\n    e.webkitMatchesSelector ||\n    e.oMatchesSelector\n  );\n}\n\nconst matchesFn = getMatchesFn();\n\nfunction matches(element, selector) {\n  return matchesFn.call(element, selector);\n}\n\nexport default function findInTree(tree, selector) {\n  if (tree.jquery) {\n    return tree.filter(selector).add(tree.find(selector)).toArray();\n  }\n\n  let roots;\n\n  if (tree instanceof HTMLElement) {\n    roots = [tree];\n  } else if (tree instanceof NodeList) {\n    roots = [].slice.call(tree);\n  } else if (Array.isArray(tree)) {\n    roots = tree;\n  } else if (typeof tree === 'string') {\n    roots = [].slice.call(document.querySelectorAll(tree));\n  }\n\n  return roots.reduce((nodes, root) => {\n    if (matches(root, selector)) {\n      nodes.push(root);\n    }\n\n    return nodes.concat(\n      [].slice.call(root.querySelectorAll(selector))\n    );\n  }, []);\n}\n","import findInTree from './selector';\n\n\nexport default class Builder {\n  constructor(id, selector, proto, plugins) {\n    this.id = id;\n    this.selector = selector;\n    this.proto = proto;\n    this.plugins = plugins;\n  }\n\n  getInitializer(tree = document.body) {\n    const nodes = findInTree(tree, this.selector);\n\n    const components = nodes.reduce((cs, node) => {\n      if (this.checkAndUpdateCache(node)) {\n        cs.push(this.createComponent(node));\n      }\n\n      return cs;\n    }, []);\n\n    return this.createInitializer(components);\n  }\n\n  createComponent(node) {\n    const component = { };\n    const properties = Object.keys(this.proto);\n\n    for (let i = 0; i < properties.length; i += 1) {\n      const property = properties[i];\n\n      if ({}.hasOwnProperty.call(this.proto, property)) {\n        component[property] = this.proto[property];\n      }\n    }\n\n    this.transformComponent(component, node);\n\n    return component;\n  }\n\n  checkAndUpdateCache(node) {\n    if (node.ids && node.ids.indexOf(this.id) !== -1) {\n      return false;\n    }\n\n    // eslint-disable-next-line\n    node.ids = node.ids ? node.ids.concat(this.id) : [this.id];\n\n    return true;\n  }\n\n  transformComponent(component, node) {\n    for (let i = 0; i < this.plugins.length; i += 1) {\n      this.plugins[i].transform(component, node);\n    }\n  }\n\n  // eslint-disable-next-line\n  createInitializer(components) {\n    return function initializer() {\n      for (let i = 0; i < components.length; i += 1) {\n        const component = components[i];\n\n        if (component.init) {\n          component.init();\n        }\n      }\n    };\n  }\n}\n","import Builder from './builder';\n\n\nexport default class Application {\n  constructor(name) {\n    this.name = name;\n    this.plugins = [];\n    this.builders = [];\n    this.isReady = false;\n    this.isRunning = false;\n  }\n\n  use(...plugins) {\n    this.plugins = this.plugins.concat(\n      this.normalize(plugins)\n    );\n\n    return this;\n  }\n\n  component(selector, proto) {\n    const id = this.builders.length;\n    const builder = new Builder(id, selector, proto, this.plugins);\n\n    this.builders.push(builder);\n\n    if (this.isRunning) {\n      const initializer = builder.getInitializer();\n\n      initializer();\n    }\n\n    return this;\n  }\n\n  vitalize(tree) {\n    for (let i = 0; i < this.builders.length; i += 1) {\n      const initialize = this.builders[i].getInitializer(tree);\n\n      initialize();\n    }\n  }\n\n  run() {\n    this.isReady = true;\n\n    if (document.readyState !== 'loading') {\n      this.start();\n    } else {\n      document.addEventListener('DOMContentLoaded', () => this.start());\n    }\n\n    return this;\n  }\n\n  start() {\n    this.isRunning = true;\n\n    this.vitalize();\n  }\n\n  normalize(plugins) {\n    return plugins.reduce((ps, p) => {\n      const instances = Array.isArray(p)\n        ? p.map(plugin => this.instantiatePlugin(plugin))\n        : this.instantiatePlugin(p);\n\n      return ps.concat(instances);\n    }, []);\n  }\n\n  // eslint-disable-next-line\n  instantiatePlugin(plugin) {\n    if (plugin instanceof Function) {\n      return plugin();\n    }\n\n    return plugin;\n  }\n}\n","export default class Plugin {\n  constructor(name, transformer) {\n    this.name = name;\n    this.transformer = transformer;\n  }\n\n  transform(component, node) {\n    this.transformer(component, node);\n  }\n}\n","import Application from './application';\nimport Plugin from './plugin';\n\n\nconst applications = {\n  default: new Application('default'),\n};\n\n\nexport default applications.default;\n\nexport function create(name = 'default') {\n  let instance = applications[name];\n\n  if (!instance) {\n    instance = new Application(name);\n\n    applications[name] = instance;\n  }\n\n  return instance;\n}\n\nexport function plugin(name, initializer) {\n  return function factory(...args) {\n    return new Plugin(name, initializer(...args));\n  };\n}\n"],"names":["const","let","this"],"mappings":"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"}